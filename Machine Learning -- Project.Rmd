Machine learning algorithm 
========================================================

### Getting the data and cleaning it:
Since the dataset is huge, we will first start by removing the NAs.
Once we do so
```{r, echo=TRUE, cache=TRUE}
library(caret)
rawdata <- read.csv("pml-training.csv",na.strings=c("NA","")) ## reading data from csv file
## Removing NAs
NAs <- apply(rawdata,2,function(x) {sum(is.na(x))}) 
data <- rawdata[,which(NAs == 0)]
inTrain <- createDataPartition(y=data$classe,
                               p=0.35, list=FALSE) ## try 0.25 next time
training <- data[inTrain,]
testing <- data[-inTrain,]
dim(training)
# discards unuseful predictors
removeIndex <- grep("timestamp|X|user_name|new_window",names(training))
training <- training[,-removeIndex]
```
### Exporing the data 
```{r, echo=TRUE, cache=TRUE}
plot(training$classe)
```
It's clear from the histogram that it's 5 factors variable. 

### Building the Machine learning algorithm
We will go with the rain forest algorithm, and we will change the train control from bootstrapping to cv,
as that will save computing time.

```{r,echo=TRUE, cache=TRUE}
#using the trainControl   
fitControl <- trainControl(method = "cv", number = 4)

## try as a factor
modFit <- train(classe~ .,
                data=training,
                method="rf",
                trControl = fitControl,
                prox=TRUE)
modFit$finalModel
```

### Sample error to be and estimate the error appropriately with cross-validation [The validation]
After creating the model for prediction, we want to test it with our validation dataset kept aside from the beginning when we sliced our training data.
```{r ,echo=TRUE, cache=TRUE}
## PREDICTIONS
predictions <- predict(modFit,testing)
## CHECKING RESULTS
confusionMatrix(predictions,testing$classe)
```
We have a 99.3% of accuracy from this model after passing it through the validation and we can see all our results from the confussion matrix.

### The test data set
Then we want to test our testing dataset, provided by the instructor, we will do the same thing and then go to the submission tab

```{r, echo=TRUE, cache=TRUE}
b <- read.csv("pml-testing.csv",na.strings=c("NA",""))
NAsb <- apply(b,2,function(x) {sum(is.na(x))}) 
ba <- b[,which(NAsb == 0)]
removeIndexb <- grep("timestamp|X|user_name|new_window",names(ba))
bas <- ba[,-removeIndexb]
answers <- predict(modFit,bas)
answers <- as.character(answers)
```